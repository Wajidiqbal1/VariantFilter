# Overview

**`VariantFilter`** is an R package designed to filter Variant Call Format (VCF) data based on various criteria. This package allows users to filter variants by zygosity, minor allele frequency (MAF), genomic region, effect, GERP scores, CADD scores, and other custom criteria.

The package was built to streamline the process of filtering large files that usually contains more than 80,000 variants and the process of applying filters in Excel sometime becomes daunting which is what motivated me to write this script. it efficiently performs the filtration process given the right column names present in your annotated **.xlsx** and **.csv** files. It handles common issues such as missing values and provides a flexible framework for applying complex filtering criteria.

The function has been tested extensively on the annotated file generated by [ANNOVAR](https://annovar.openbioinformatics.org/en/latest/user-guide/startup/) but other annotators files has also been tested. For more information regarding ANNOVAR annotation and what score is best or what score implies what for each damaging tools i.e for CADD, GERP, and other mutation damaging tools, please refer to the following links where the functional annotation pdf file is written by **Isabelle Schrauwen** and **Suzanne M.leal** (prominent members in the field of Medical Genetics) and the repository is maintained by **gao wang** under the name of [statgen_course](https://github.com/statgenetics/statgen-courses):

-   [Functional Annotation Handout](https://github.com/statgenetics/statgen-courses/blob/master/handout/FunctionalAnnotation.pdf)
-   [ANNOVAR Annotation Pipeline](https://github.com/Wajidiqbal1/Variant_calling_pipenline_annotation_using_annovar/blob/main/annovar.sh)

# Features

-   Filter by zygosity (e.g., heterozygous, homozygous).
-   Filter by allelic frequency (MAF).
-   Filter by genomic region (e.g., exonic, intronic).
-   Filter by variant effect (e.g., missense, frameshift).
-   Filter by GERP scores.
-   Filter by CADD scores.
-   Apply custom filters.

# Installation

You can install the development version of **VariantFilter** from GitHub with:

```{r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("Wajidiqbal1/VariantFilter")
```

# Usage

The basic usage example is provided below. Since each annotator generates different datasets with varying column names, sorting out this pattern was one of the challenging aspects of this function. Therefore, a column name generation function has been added upfront in the script. If you encounter an error stating that "this column is not present in your data" even though it is present, copy and paste the column name generated by R when you run the function. This function also generates a summary at each level, indicating how many variants have been filtered at each stage. 
**Disclaimer**: this function does not compute/perform any statistical analysis, it only filters the data based on the criteria and the coloumn provided. the fucntion perform operation in this way: Region filtering/Effect/Zygosity/Allelic frequency and these are compulsory arguments apart from these four all other are optional.


# Example

Here is the example usage of all possible parameters:

```{r, eval=FALSE}
library(VariantFilter)
filter_vcf_tidy(
  input_file = "query.output.exome_summary.csv",
  output_file = "test_filtered_class_output.csv",
  zygosity_column = "Zygosity",
  zygosity_value = "het",
  maf_criteria = "<=0.001",
  exome_column = "gnomAD_exome_ALL",
  genome_column = "gnomAD_genome_ALL",
  region_column = "Func.refGene",
  region_filters = "exonic",
  effect_column = "ExonicFunc.refGene",
  effect_filters = c("nonsynonymous SNV", "stoploss"),
  gerp_column = "GERP.._RS",
  gerp_criteria = ">=3",
  cadd_column = "CADD_phred",
  cadd_criteria = ">=20",
  custom_filters = list(
    list(column = "SIFT_pred", criteria = "== 'D'"),
    list(column = "PROVEAN_pred", criteria = "== 'D'"),
    list(column = "LRT_pred", criteria = "== 'D'")
  )
)
```

## Handling Missing Values

One of the key challenges was accurately importing .xlsx and .csv files and properly handling missing values. To address this, we ensured the function replaces NA values with default values that would be filtered out during normal filtration processes, such as allelic frequency less than 0.5, GERP score greater than 2, or CADD score greater than 10. Below are the strategies implemented in `VariantFilter` to deal with missing data by setting default values:

-   **Exome and Genome Columns:** Missing values were replaced with a default value of `10`.
-   **GERP Scores:** Missing values were replaced with `-1`.
-   **CADD Scores:** Missing values were replaced with `-40`.

These default values were chosen to ensure that the filtering process can proceed without interruption due to missing data.

## Contributing

Contributions are welcome! Please open an issue or submit a pull request on GitHub.

## License

This package is licensed under the MIT License.

## Contact

For any questions or suggestions, please contact Wajid Iqbal at [wwajidiqbal\@gmail.com](mailto:wwajidiqbal@gmail.com).
